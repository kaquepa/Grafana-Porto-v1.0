<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Simulador Portuário Realista</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f0f8ff;
    }

    h1 {
      text-align: center;
      color: #2c3e50;
      margin-bottom: 30px;
    }

    .porto-container {
      display: flex;
      flex-wrap: nowrap;
      overflow-x: auto;
      padding: 40px 0 100px;
      gap: 30px;
      justify-content: center;
      align-items: flex-end;
      min-height: 400px;
      background: linear-gradient(to bottom, #1e90ff, #0077be);
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      position: relative;
    }

    .navio-container {
      position: relative;
      margin: 0;
      flex-shrink: 0;
      z-index: 2;
    }

    .grua-container {
      position: absolute;
      top: -250px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 10;
    }

    .controls {
      text-align: center;
      margin-bottom: 15px;
      background: rgba(255,255,255,0.9);
      padding: 8px 12px;
      border-radius: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
      border: 1px solid #ddd;
    }

    label {
      font-size: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      color: #2c3e50;
      font-weight: bold;
    }

    input[type="checkbox"] {
      cursor: pointer;
      transform: scale(1.2);
    }

    .water-effect {
      position: absolute;
      bottom: 0;
      width: 100%;
      height: 60px;
      background: 
        linear-gradient(to bottom, transparent, rgba(255,255,255,0.3)),
        repeating-linear-gradient(
          to bottom,
          transparent,
          transparent 10px,
          rgba(255,255,255,0.4) 10px,
          rgba(255,255,255,0.4) 20px
        );
      z-index: 1;
    }

    .wave {
      position: absolute;
      bottom: 0;
      width: 100%;
      height: 20px;
      background: url('data:image/svg+xml;utf8,<svg viewBox="0 0 1200 120" xmlns="http://www.w3.org/2000/svg"><path d="M0,0V46.29c47.79,22.2,103.59,32.17,158,28,70.36-5.37,136.33-33.31,206.8-37.5C438.64,32.43,512.34,53.67,583,72.05c69.27,18,138.3,24.88,209.4,13.08,36.15-6,69.85-17.84,104.45-29.34C989.49,25,1113-14.29,1200,52.47V0Z" fill="%230077be" opacity=".25"/><path d="M0,0V15.81C13,36.92,27.64,56.86,47.69,72.05,99.41,111.27,165,111,224.58,91.58c31.15-10.15,60.09-26.07,89.67-39.8,40.92-19,84.73-46,130.83-49.67,36.26-2.85,70.9,9.42,98.6,31.56,31.77,25.39,62.32,62,103.63,73,40.44,10.79,81.35-6.69,119.13-24.28s75.16-39,116.92-43.05c59.73-5.85,113.28,22.88,168.9,38.84,30.2,8.66,59,6.17,87.09-7.5,22.43-10.89,48-26.93,60.65-49.24V0Z" fill="%230077be" opacity=".5"/><path d="M0,0V5.63C149.93,59,314.09,71.32,475.83,42.57c43-7.64,84.23-20.12,127.61-26.46,59-8.63,112.48,12.24,165.56,35.4C827.93,77.22,886,95.24,951.2,90c86.53-7,172.46-45.71,248.8-84.81V0Z" fill="%230077be"/></svg>');
      background-size: 1200px 100px;
      animation: wave 12s linear infinite;
      z-index: 1;
    }

    @keyframes wave {
      0% { background-position-x: 0; }
      100% { background-position-x: 1200px; }
    }
  </style>
</head>
<body>
  <h1>Simulador Portuário - Porto de Sines</h1>
  <div class="porto-container" id="porto">
    <div class="water-effect"></div>
    <div class="wave"></div>
  </div>

  <script>
    const navioSvg = (index) => `
      <svg width="400" height="250" viewBox="0 0 400 250" xmlns="http://www.w3.org/2000/svg">
        <!-- Fundo do mar -->
        <rect x="0" y="180" width="400" height="70" fill="#0077be" />
        
        <!-- Reflexo da água -->
        <path d="M30,180 Q200,220 370,180 L370,250 Q200,230 30,250 Z" fill="rgba(255,255,255,0.2)" />
        
        <!-- Navio (vista lateral 3D) -->
        <path d="M50,150 L350,150 L330,180 L70,180 Z" fill="#1a3a7d" />
        <path d="M70,120 L330,120 L350,150 L50,150 Z" fill="#2a4b8d" />
        <rect x="100" y="100" width="200" height="20" fill="#34495e" rx="2" />

        <!-- Containers no navio -->
        <g id="navioContainers${index}">
          <rect x="110" y="105" width="30" height="15" fill="#e74c3c" />
          <rect x="150" y="105" width="30" height="15" fill="#f39c12" />
          <rect x="190" y="105" width="30" height="15" fill="#2ecc71" />
          <rect x="230" y="105" width="30" height="15" fill="#3498db" />
          <rect x="110" y="85" width="30" height="15" fill="#9b59b6" />
          <rect x="150" y="85" width="30" height="15" fill="#1abc9c" />
          <rect x="190" y="85" width="30" height="15" fill="#d35400" />
          <rect x="230" y="85" width="30" height="15" fill="#7f8c8d" />
        </g>

        <!-- Janelas e detalhes -->
        <circle cx="130" cy="110" r="3" fill="#f1c40f" />
        <circle cx="150" cy="110" r="3" fill="#f1c40f" />
        <circle cx="170" cy="110" r="3" fill="#f1c40f" />

        <!-- Nome do navio -->
        <text x="200" y="95" text-anchor="middle" font-size="12" fill="white">NAVIO ${index + 1}</text>

        <!-- Espuma do navio -->
        <path d="M70,180 Q90,175 110,180 Q130,185 150,180 Q170,175 190,180 Q210,185 230,180 Q250,175 270,180 Q290,185 310,180 Q330,175 350,180" 
              stroke="white" stroke-width="1" fill="none" stroke-dasharray="5,3" />
      </svg>
    `;

    const gruaTemplate = (index) => `
      <div class="grua-container">
        <div class="controls">
          <label>
            <input type="checkbox" id="toggleGrua${index}" checked>
            Grua ${index + 1}
          </label>
        </div>
        <svg width="400" height="250" viewBox="0 0 400 250" xmlns="http://www.w3.org/2000/svg">
          <!-- Base da grua -->
          <rect x="180" y="50" width="40" height="180" fill="#5D8AA8" rx="2" />
          <rect x="170" y="40" width="60" height="10" fill="#4A708B" rx="2" />
          
          <!-- Braço móvel -->
          <rect id="braco${index}" x="20" y="40" width="360" height="20" fill="#6E7B8B" rx="2" />
          
          <!-- Mecanismo de transporte -->
          <g id="carrinho${index}" transform="translate(180, 0)">
            <rect x="0" y="35" width="40" height="25" fill="#FFD700" rx="2" />
            <rect x="5" y="60" width="30" height="5" fill="#CDAD00" rx="1" />
            <!-- Cabo realista com polia -->
            <circle cx="20" cy="85" r="8" fill="#AAA" stroke="#555" stroke-width="2" />
            <circle cx="20" cy="85" r="4" fill="#777" />
            <line x1="20" y1="60" x2="20" y2="77" stroke="#555" stroke-width="2" />
            <line x1="20" y1="93" x2="20" y2="120" stroke="#555" stroke-width="2" />
          </g>
          
          <!-- Container sendo movimentado -->
          <g id="container${index}" style="display: none;">
            <rect x="180" y="120" width="40" height="25" fill="#FFA500" stroke="#333" stroke-width="1" rx="2" />
            <rect x="185" y="125" width="30" height="15" fill="#FFC040" rx="1" />
          </g>
          
          <!-- Estado desligado -->
          <g id="offState${index}" style="display: none;">
            <rect x="160" y="70" width="80" height="40" fill="rgba(0,0,0,0.7)" rx="4" />
            <text x="200" y="95" text-anchor="middle" font-size="16" fill="white" font-weight="bold">OFF</text>
          </g>
        </svg>
      </div>
    `;

    function criarGrua(index) {
      let carrinhoPos = 180;
      let containerHeight = 120;
      let direction = 1;
      let animationId = null;
      let isWorking = true;
      let currentState = 'descendo'; // 'descendo', 'subindo', 'movendo', 'retornando'
      let containerColors = ['#e74c3c', '#f39c12', '#2ecc71', '#3498db', '#9b59b6', '#1abc9c', '#d35400', '#7f8c8d'];
      let currentContainerIndex = 0;
      
      // Aguarda um momento para os elementos serem criados
      setTimeout(() => {
        const navioContainers = document.getElementById(`navioContainers${index}`);
        const container = document.getElementById(`container${index}`);
        const braco = document.getElementById(`braco${index}`);
        const carrinho = document.getElementById(`carrinho${index}`);
        const offState = document.getElementById(`offState${index}`);
        const toggle = document.getElementById(`toggleGrua${index}`);
        
        if (!navioContainers || !container || !braco || !carrinho || !offState || !toggle) {
          console.error(`Elementos não encontrados para grua ${index}`);
          return;
        }
        
        let containerCarregado = false;

        function animate() {
          if (!isWorking) return;
          
          switch(currentState) {
            case 'descendo':
              // Movimento vertical descendente
              containerHeight += 1;

              // Quando chegar no navio
              if (containerHeight >= 150) {
                containerHeight = 150;
                currentState = 'pegando';
                setTimeout(() => {
                  // Pegar um container do navio
                  if (currentContainerIndex < navioContainers.children.length) {
                    const containerRect = container.querySelector('rect');
                    if (containerRect) {
                      containerRect.setAttribute('fill', containerColors[currentContainerIndex]);
                    }
                    container.style.display = 'inline';
                    navioContainers.children[currentContainerIndex].style.display = 'none';
                    currentContainerIndex++;
                    containerCarregado = true;
                  }
                  currentState = 'subindo';
                }, 500);
              }
              break;
              
            case 'subindo':
              // Movimento vertical ascendente
              containerHeight -= 1;

              // Quando chegar no topo
              if (containerHeight <= 80) {
                containerHeight = 80;
                currentState = 'movendo';
                direction = 1; // Move para a direita
              }
              break;
              
            case 'movendo':
              // Movimento horizontal para depositar
              carrinhoPos += direction;

              // Quando chegar no destino
              if (carrinhoPos >= 300) {
                carrinhoPos = 300;
                currentState = 'depositando';
                setTimeout(() => {
                  // Depositar o container
                  container.style.display = 'none';
                  containerCarregado = false;
                  currentState = 'retornando';
                }, 500);
              }
              break;
              
            case 'retornando':
              // Movimento horizontal de retorno
              carrinhoPos -= direction;

              // Quando voltar à posição inicial
              if (carrinhoPos <= 180) {
                carrinhoPos = 180;
                // Reinicia o ciclo se ainda há containers
                if (currentContainerIndex < navioContainers.children.length) {
                  currentState = 'descendo';
                } else {
                  // Reset para começar novamente
                  currentContainerIndex = 0;
                  // Mostra todos os containers novamente
                  for (let i = 0; i < navioContainers.children.length; i++) {
                    navioContainers.children[i].style.display = 'inline';
                  }
                  currentState = 'descendo';
                }
              }
              break;
          }
          
          // Atualiza posições
          carrinho.setAttribute("transform", `translate(${carrinhoPos}, 0)`);
          container.setAttribute("transform", `translate(${carrinhoPos-180}, ${containerHeight-120})`);
          
          animationId = requestAnimationFrame(animate);
        }

        function stop() {
          if (animationId) {
            cancelAnimationFrame(animationId);
            animationId = null;
          }
        }

        function atualizar(ativo) {
          isWorking = ativo;
          
          if (ativo) {
            braco.setAttribute("fill", "#6E7B8B");
            carrinho.style.display = "inline";
            offState.style.display = "none";
            animate();
          } else {
            stop();
            braco.setAttribute("fill", "#9E9E9E");
            carrinho.style.display = "none";
            container.style.display = "none";
            offState.style.display = "inline";
          }
        }

        toggle.addEventListener("change", () => {
          atualizar(toggle.checked);
        });

        // Inicia com um pequeno delay para evitar sincronização perfeita entre gruas
        setTimeout(() => {
          atualizar(true);
        }, index * 1000);
        
      }, 100);
    }

    const porto = document.getElementById("porto");
    const totalNavios = 4;

    for (let i = 0; i < totalNavios; i++) {
      const div = document.createElement("div");
      div.className = "navio-container";
      div.innerHTML = gruaTemplate(i) + navioSvg(i);
      porto.appendChild(div);
      criarGrua(i);
    }
  </script>
</body>
</html>